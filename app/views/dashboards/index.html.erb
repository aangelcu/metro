
<div class="row">
	<div class="col-sm-4">
	<%= form_tag root_path, method: :get do %>

	<p>
		<%= label_tag("From") %>
		<%= date_field_tag(:from) %>
	</p>

	<p>
		<%= label_tag("To") %>
		<%= date_field_tag(:to) %>
	</p>

	<p>
		<%= label_tag("Mercado") %>
		<select name="category">
			<option value="sale">Venta</option>
			<option value="rent">Alquiler</option>
		</select>
	</p>

	<p>
		<%= label_tag("Tipo_de_Propiedad") %>
		<%= select_tag :property_type_id, options_from_collection_for_select( PropertyType.all, "id", "type", params[:property_type_id]) %>
	</p>

	<p>
		<%= label_tag("Departamento") %>
		<%= select_tag :state_id, options_from_collection_for_select(State.all, "id","name", params[:state_id]) %>
	</p>

	<p>
		<%= label_tag("Estrato") %>
		<%= select_tag :stratus, options_for_select([1, 2, 3, 4, 5, 6], params[:stratus]) %>
	</p>

	<p>
		<%= label_tag("Area_Construida") %>
		<%= select_tag :built_area_range, options_for_select([["0 a 100 M2", 0], ["101 a 200 M2", 1], ["201 a 300 M2", 2]]) %>
	</p>

	<p>
		<%= submit_tag "Submit", name: nil, class: "btn btn-primary btn-md" %>
	</p>
	<% end %>
	</div>		<!-- end of col sm3  -->

<!-- Table Results  -->
<div class="col-sm-8">
	<table class="table table-bordered" >
		<tr>
			<th>Area Construida</th>
			<th>Estrato</th>
			<th>Tipo de Propiedad</th>
			<th>Departamento</th>
			<th>Ciudad</th>
			<th>Barrio</th>
			<th>Mercado</th>
		</tr>
		<% @properties.each do |p| %>
		<tr>
			<td>
				<%= p.built_area %>
			</td>
			<td>
				<%= p.stratus %>
			</td>
			<td>
				<%= p.property_type.try(:type) %>
			</td>
			<td>
				<%= p.try(:zone).try(:city).try(:state).try(:name) %>
			</td>
			<td>
				<%= p.try(:zone).try(:city).try(:name) %>
			</td>
			<td>
				<%= p.zone.try(:name) %>
			</td>
			<td>
				<%= p.category %>
			</td>
		</tr>
		<% end %> 
	</table>
</div>   <!-- end of table  -->
</div>		<!-- end of row  -->

<!-- Graph  -->
<div class="row">
<%= content_tag :div, "", id: "m2_chart", data: {properties: properties_chart_data(params[:from].to_date)} %>
<!-- <div id="m2_chart" style="height: 250px;"></div> -->
</div>   <!-- end of Graph  -->

<!-- Morris Script for Graphs  -->
<script> 
new Morris.Line({
  element: 'm2_chart',
  data: $('#m2_chart').data('properties'),
  xkey: 'created_at',
  ykeys: ['m2_sale_value'],
  labels: ['M2_Value']
});
</script>
<!-- end of Morris Script  -->
